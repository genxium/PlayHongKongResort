String.prototype.format=function(){var c=this;for(var a=0;a<arguments.length;a++){var b=new RegExp("\\{"+a+"\\}","gi");c=c.replace(b,arguments[a])}return c};var RELATION_NAMES={applied:"已報名",selected:"被選上啦",present:"與席",absent:"缺席",assessed:"已評價",hosted:""};var STATUS_NAMES={created:"已創建",pending:"等待審核",rejected:"未通過審核",accepted:"已通過審核"};var TITLES={create:"創建",profile:"個人",register:"註冊帳號",login:"登入",logout:"登出",forgot_password:"忘記密碼",upload:"上傳",choose_picture:"選擇圖片",edit:"編輯","delete":"刪除",update:"更新",save:"保存",submit:"提交",cancel:"取消",detail:"詳情",view:"詳細",join:"報名",begin_time:"開始時間",deadline:"報名截止",selected:"選中",applied:"報名",yes:"是",no:"否",submit_comment_question:"提交問題",submit_comment_reply:"提交",collapse:"收起",reply:"回覆",replied_to:"對@{0}: ",time_ascendant:"時間順序",time_descendant:"時間倒序",joined_activities:"參與的活動",hosted_activities:"發起的活動",question:"Q & A",participant:"參與者",assessment:"評價",view_assessment:"查看Ta收到的評價 >",assessment_disabled:"不可用",present:"已出席",absent:"未出席",from:"來自",content:"內容",by_host:"由 @{0} 發起",view_all_replies:"查看全部回覆({0})",about_us:"關於我們",contact_us:"聯絡我們",privacy_policy:"隱私聲明",resend_email_verification:"重發驗證郵件",submit_participant_selection:"提交",new_password:"新密碼",confirm_new_password:"確認新密碼",input_to_reset_password:"請輸入新密碼並提交以完成修改",add_image:"+",send:"發送",check_all:"全選",uncheck_all:"清空已選",ascendant:"順序",descendant:"倒序",automatic:"自動",time:"時間",last_accepted_time:"審核完成時間","default":"默認",age:"年齡",gender:"性別",mood:"心情"};var MESSAGES={saving:"正在保存...",saved:"已保存",save_failed:"保存失敗",uploading:"正在上傳...",uploaded:"上傳成功",upload_failed:"上傳失敗",delete_activity_confirmation:"確定要刪除此活動嗎？",username_requirement:"用戶名需為6-32位由英文字母， 數字或符號'_'組成",username_valid:"此用戶名可以使用",username_invalid:"此用戶名已被佔用",email_valid:"此電郵地址可以使用",email_invalid:"此電郵地址已被佔用",email_requirement:"請填寫有效的電郵地址",password_requirement:"密碼需為6~32位由英文字母，數字或符號'#'，'_'及'!'組成",password_confirm_requirement:"密碼不匹配",age_requirement:"請填寫0～16個字",gender_requirement:"請填寫0～16個字",mood_requirement:"請填寫0～64個字",comment_reply_not_submitted:"回覆未提交",assessment_requirement:"請填寫0～64個字",age_requirement:"請填寫0～16個字",gender_requirement:"請填寫0～16個字",mood_requirement:"請填寫0～64個字",comment_disabled_activity_has_begun:"Q&A時間已經結束",comment_disabled_activity_not_accepted:"活動尚未通過審核",email_verification_success:"Hi @{0}， 你的電郵地址{1}已完成驗證， {2}秒後將為你跳轉到首頁",email_verification_failure:"Hi @{0}， 很遺憾你的電郵地址{1}未能通過驗證， 如需幫助請與hongkongresort@126.com聯繫",about_us:"關於我們\n\r\n\r仲未寫",privacy_policy:"隱私聲明\n\r\n\r仲未寫",please_wait:"請稍後...",email_verification_sent:"驗證郵件已發送到你的註冊郵箱{0}, 請查收",email_verification_not_sent:"未能成功發送驗證郵件, 請重試",image_selection_requirement:"請選擇不多於3張圖片輔助活動說明, 每張圖片應不超過2MB(2048KB), 如需編輯或壓縮圖片可以使用<a target='_blank' href='http://www.pixlr.com'>Pixlr</a>",activity_created:"活動已創建, 你可以在個人主頁查看相關信息",activity_saved:"更新已保存",activity_not_saved:"保存不成功",activity_saving:"正在保存...",instructions_sent_to:"密碼重設郵件已發送至{0}, 請查收",instructions_not_sent:"郵件發送失敗， 請重試",password_reset_tips:"請輸入你的註冊電郵地址",notice:"請注意",password_reset_notice_1:"若電郵地址未在本站註冊， 你將無法收到所需郵件",password_reset_notice_2:"若電郵地址不存在， 你將無法收到所需郵件",password_reset_notice_3:"電郵地址所關聯帳號在申請密碼重設期間不會失效， 如需凍結帳號請通過<a href=\"mailto:admin@qiutongqu.com?subject='account suspension'\">admin@qiutongqu.com</a>聯繫我們"};var HINTS={username:"用戶名",email:"電郵地址",password:"密碼",confirm_password:"確認密碼",title:"標題",address:"地址",content:"內容",activity_title:"標題",activity_address:"活動地點",activity_content:"活動內容",captcha:"驗證碼",reply:"對@{0}說: "};var ALERTS={captcha_not_matched:"驗證碼錯誤",creation_limit_exceeded:"創建活動太頻繁囉， 請稍後片刻",applicant_num_exceeded:"報名人數已達到上限",selected_num_exceeded:"已選人數已達到上限",deadline_expired:"報名已截止",image_selection_limit_exceeded:"請選擇{0}張以內圖片",invalid_email_format:"無效的電郵地址",wrong_password:"密碼錯誤",user_not_existing:"用戶不存在",comment_requirement:"請填寫5～128個字",comment_question_not_submitted:"問題未提交",registered:"註冊成功",not_registered:"註冊不成功",not_permitted_to_view_detail:"你無權瀏覽此頁",activity_not_begun:"活動尚未開始",assessment_submitted:"評價已成功提交",assessment_not_submitted:"評價未提交",no_assessment:"Oops! 暫時沒有人給Ta留下評價喔",choose_one_image:"一次只能選擇一張圖片",please_log_in:"請先登入",image_selection_requirement:"請選擇不多於3張圖片輔助活動說明, 每張圖片應不超過2MB(2048KB)",deadline_behind_begin_time:"報名截止時間應在活動開始時間之前",please_follow_activity_field_instructions:"請根據字數要求填寫各項",not_updated:"更新不成功",email_not_authenticated:"註冊郵箱尚未完成驗證無法進行此操作， 如未收到驗證郵件請在個人主頁點擊重新發送",invalid_image_type:"圖片類型應為jpg, jpeg或png"};var g_numItemsPerPage=6;var g_baseTwo=2;var g_baseTen=10;var g_rootElement=$(":root");var g_inf=(1<<53);var g_orderDescend=(-1);var g_orderAscend=(+1);var g_directionForward=(+1);var g_directionBackward=(-1);var g_modeHomepage=0;var g_modeProfile=1;var g_idKeyboardEnter=13;var g_keyToken="token";var g_keyId="id";var g_keyOrderKey="order_key";var g_keyRelation="relation";var g_keyBundle="bundle";var g_keyRet="ret";var g_keyCount="count";var g_keyData="data";var g_keyUser="user";var g_keyCode="code";var g_keyUserId="user_id";var g_keyVieweeId="viewee_id";var g_keyName="name";var g_keyEmail="email";var g_keyPassword="password";var g_keyAvatar="avatar";var g_keyPasswordResetCode="password_reset_code";var g_keyUnreadCount="unread_count";var g_keyUnassessedCount="unassessed_count";var g_keyAge="age";var g_keyGender="gender";var g_keyMood="mood";var g_keyButton="button";var g_keyActivities="activities";var g_keyActivity="activity";var g_keyActivityId="activity_id";var g_keyTitle="title";var g_keyAddress="address";var g_keyContent="content";var g_keyCreatedTime="created_time";var g_keyBeginTime="begin_time";var g_keyDeadline="application_deadline";var g_keyImages="images";var g_keyStatus="status";var g_keyHostId="host_id";var g_keyHostName="host_name";var g_keyPriority="priority";var g_keyOrderMask="order_mask";var g_keyAppliedParticipants="applied_participants";var g_keySelectedParticipants="selected_participants";var g_keyPresentParticipants="present_participants";var g_keyAbsentParticipants="absent_participants";var g_keyImageId="image_id";var g_keyUrl="url";var g_keyComment="comment";var g_keyCommentId="comment_id";var g_keyParentId="parent_id";var g_keyPredecessorId="predecessor_id";var g_keyCommentType="type";var g_keyGeneratedTime="generated_time";var g_keyComments="comments";var g_keySubComments="sub_comments";var g_keyFrom="from";var g_keyFromName="from_name";var g_keyTo="to";var g_keyToName="to_name";var g_keyNotification="notification";var g_keyNotifications="notifications";var g_keyIsRead="is_read";var g_keyPage="page";var g_keyPageSt="page_st";var g_keyPageEd="page_ed";var g_keyRefIndex="ref_index";var g_keyNumItems="num_items";var g_keyOrder="order";var g_keyOrientation="orientation";var g_keyDirection="direction";var g_keyCell="cell";var g_keySid="sid";var g_keyCaptcha="captcha";var g_statusCreated=0;var g_statusPending=1;var g_statusRejected=2;var g_statusAccepted=3;var g_maxApplied=500;var g_maxSelected=250;var g_emailPattern=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;var g_passwordPattern=/^[0-9a-zA-Z_#\\!]{6,32}$/;var g_usernamePattern=/^[0-9a-zA-Z_]{6,32}$/;var g_userAgePattern=/^.{0,16}$/;var g_userGenderPattern=/^.{0,16}$/;var g_userMoodPattern=/^.{0,64}$/;var g_activityTitlePattern=/^.{5,64}$/;var g_activityAddressPattern=/^.{5,128}$/;var g_activityContentPattern=/^[\s\S]{15,1024}$/;var g_commentContentPattern=/^.{5,128}$/;var g_assessmentContentPattern=/^.{0,64}$/;var g_errNotLoggedIn=1001;var g_errUserNotFound=1003;var g_errPswErr=1004;var g_errActivityHasBegun=3007;var g_errActivityAppliedLimit=3008;var g_errActivitySelectedLimit=3009;var g_errActivityCreationLimit=3010;var g_errCaptcha=4001;var g_theme="main";function callbackOnPageLoaded(c,a){if(a==null){return}var b=false;c.onload=c.onreadystatechange=function(){var d=(this.readyState==null||this.readyState=="complete");if(b||!d){return}b=true;a()}}function loadJavaScript(d,f,i){var g=d.document;if(g==null){return}var c=g.createElement("script");var b=g.createTextNode(f);c.appendChild(b);if(i!=null){var a=false;c.onload=c.onreadystatechange=function(){var j=(this.readyState==null||this.readyState=="complete");if(a||!j){return}a=true;i()}}var h=g.getElementsByTagName("head");if(h==null){return}var e=h[0];if(e==null){return}e.appendChild(c)}function loadScriptFile(g,h,e,a){var d=null;if(e=="js"){d=g.document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",h)}else{if(e=="css"){d=g.document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",h)}else{}}if(typeof d=="undefined"){return}if(a!=null){var c=false;scriptNode.onload=scriptNode.onreadystatechange=function(){var i=(this.readyState==null||this.readyState=="complete");if(c||!i){return}c=true;a()}}var f=g.document.getElementsByTagName("head");if(f==null){return}var b=f[0];if(b==null){return}b.appendChild(d)}function loadJquery(b,a){loadScriptFile(b,"assets/javascripts/jquery-2.0.3.min.js","js",a)}function loadJqueryPlugins(a){loadScriptFile(a,"assets/javascripts/jquery-cookie.js","js",null);loadScriptFile(a,"assets/javascripts/jquery-ui.js","js",null)}function loadCommonScripts(a){loadScriptFile(a,"assets/javascripts/global_variables.js","js",null);loadScriptFile(a,"assets/javascripts/global_functions.js","js",null)}function validateEmail(a){var b=g_emailPattern;return b.test(a)}function validatePassword(a){var b=g_passwordPattern;return b.test(a)}function validateName(a){var b=g_usernamePattern;return b.test(a)}function validateUserAge(a){var b=g_userAgePattern;return b.test(a)}function validateUserGender(a){var b=g_userGenderPattern;return b.test(a)}function validateUserMood(b){var a=g_userMoodPattern;return a.test(b)}function validateActivityTitle(b){var a=g_activityTitlePattern;return a.test(b)}function validateActivityAddress(a){var b=g_activityAddressPattern;return b.test(a)}function validateActivityContent(b){var a=g_activityContentPattern;return a.test(b)}function validateCommentContent(b){var a=g_commentContentPattern;return a.test(b)}function validateAssessmentContent(b){var a=g_assessmentContentPattern;return a.test(b)}function extractTagAndParams(b){var f=/https?:\/\/(.+)#(default|profile|detail|home|search|notifications|success|failure)\??(.*)/i;var d=f.exec(b);if(d==null){return null}var a={};a.tag=d[2];a.params={};var h=d[3];var e=/(\w+)=([@\.\w]+)/g;matchParams=e.exec(h);while(matchParams!=null){var c=matchParams[1];var g=matchParams[2];a.params[c]=g;matchParams=e.exec(h)}return a}function firstChild(b,a){return $(b.children(a)[0])}function truncateMillisec(a){try{var c=a.split(".");if(c.length<=1){throw"oops!"}return c[0]}catch(b){return a}}function getCurrentYmdhisDate(){var b=new Date();var a=b.getFullYear().toString()+"-"+(b.getMonth()+1).toString()+"-"+b.getDate().toString();var c=b.getHours().toString()+":"+b.getMinutes().toString()+":"+b.getSeconds().toString();return a+" "+c}function compareYmdhisDate(j,h){var g=new Array();var c=new Array();var e=j.split(" ");var a=e[0].split("-");var b=e[1].split(":");for(var d in a){g.push(parseInt(a[d]))}for(var d in b){g.push(parseInt(b[d]))}var e=h.split(" ");var a=e[0].split("-");var b=e[1].split(":");for(var d in a){c.push(parseInt(a[d]))}for(var d in b){c.push(parseInt(b[d]))}for(var f=0;f<g.length;f++){if(g[f]<c[f]){return -1}if(g[f]>c[f]){return +1}}return 0}function getTarget(a){return $(a.srcElement?a.srcElement:a.target)}function isChecked(a){return(a!=null&&a.is(":checked"))}function isHidden(a){return(a!=null&&a.is(":hidden"))}function checkField(a){if(a==null){return}a.prop("checked",true)}function uncheckField(a){if(a==null){return}a.prop("checked",false)}function disableField(a){if(a==null){return}a.prop("disabled",true)}function enableField(a){if(a==null){return}a.prop("disabled",false)}function setMargin(e,d,c,b,a){if(e==null){return}if(d!=null){e.css("margin-left",d)}if(c!=null){e.css("margin-top",c)}if(b!=null){e.css("margin-right",b)}if(a!=null){e.css("margin-bottom",a)}}function setBackgroundImageDefault(b,a){if(b==null){return}setBackgroundImage(b,a,"contain","no-repeat","center")}function setBackgroundImage(e,b,c,d,a){if(e==null){return}e.css("background-image","url("+b+")");e.css("background-size",c);e.css("-o-background-size",c);e.css("-moz-background-size",c);e.css("-webkit-background-size",c);e.css("background-repeat",d);e.css("background-position",a)}function setDimensions(c,b,a){if(c==null){return}if(b!=null){c.css("width",b)}else{c.css("width","auto")}if(a!=null){c.css("height",a)}else{c.css("height","auto")}}function getDimensions(a){if(a==null){return{width:"0px",height:"0px"}}return{width:a.css("width"),height:a.css("height")}}function setOffset(c,b,a){if(c==null){return}if(b!=null){c.css("left",b)}else{c.css("left","auto")}if(a!=null){c.css("top",a)}else{c.css("top","auto")}}function getOffset(a){if(a==null){return{left:"0px",top:"0px"}}return{left:parseFloat(a.css("left")),top:parseFloat(a.css("top"))}}function stencilize(a){if(a==null){return}a.css("background-color","DimGray");a.css("color","Gainsboro")}function isFileValid(b){if(b==null){return false}var a=(1<<21);if(b.size>a){return false}return true}function validateImage(a){if(a==null){return false}if(!isFileValid(a)){alert("Please choose an image that is less the 2MB(2048KB) in size");return false}var c=a.value==null?a.name:a.value;var b=c.split(".").pop().toLowerCase();if($.inArray(b,["png","jpg","jpeg"])==-1){alert(ALERTS.invalid_image_type);return false}return true}function currentMillis(){var a=new Date();return 1000*moment().zone(a.getTimezoneOffset()).unix()}function gmtMiilisecToLocalYmdhis(b){var a=new Date();return moment(b).zone(a.getTimezoneOffset()).format("YYYY-MM-DD HH:mm:ss")}function gmtMiilisecToLocalYmdhi(b){var a=new Date();return moment(b).zone(a.getTimezoneOffset()).format("YYYY-MM-DD HH:mm")}function localYmdhisToGmtMillisec(a){var b=new Date();return 1000*moment(a,"YYYY-MM-DD HH:mm:ss").zone(b.getTimezoneOffset()).unix()}function generateUuid(){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function isStandardSuccess(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==0}function isStandardFailure(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==1}function isCaptchaNotMatched(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==g_errCaptcha}function isTokenExpired(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==g_errNotLoggedIn}function isUserNotFound(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==g_errUserNotFound}function isPswErr(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==g_errPswErr}function isApplicantLimitExceeded(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==g_errActivityAppliedLimit}function isSelectedLimitExceeded(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==g_errActivitySelectedLimit}function isCreationLimitExceeded(b){if(b==null){return false}if(!b.hasOwnProperty(g_keyRet)){return false}var a=parseInt(b[g_keyRet]);return a==g_errActivityCreationLimit}function toggleScaling(a){this.animate({transform:"scale(1.3, 1.3)"},300);this.animate({transform:"none"},300)}var invalid=0;var applied=(1<<0);var selected=(1<<1);var present=(1<<2);var absent=(1<<3);var assessed=(1<<4);var hosted=(1<<5);function User(a){this.id=parseInt(a.id);if(a.hasOwnProperty("email")){this.email=a.email}this.name=a.name;this.avatar=(a.hasOwnProperty("avatar")?a.avatar:"/assets/icons/anonymous.png");if(a.hasOwnProperty("unread_count")){this.unreadCount=parseInt(a.unread_count)}this.hasAvatar=function(){return(this.avatar!=null&&this.avatar!=undefined)};if(a.hasOwnProperty("group_id")){this.groupId=parseInt(a.group_id)}this.isVisitor=function(){return(this.groupId==null||this.groupId==undefined||this.groupId==0)};if(a.hasOwnProperty("age")){this.age=a.age}else{this.age=""}if(a.hasOwnProperty("gender")){this.gender=a.gender}else{this.gender=""}if(a.hasOwnProperty("mood")){this.mood=a.mood}else{this.mood=""}}function Image(a){this.id=parseInt(a.id);this.url=a.url}function Activity(b){this.id=parseInt(b.id);this.title=b.title;this.address=b.address;this.content=b.content;this.createdTime=parseInt(b.created_time);this.applicationDeadline=parseInt(b.application_deadline);this.isDeadlineExpired=function(){var p=new Date();var o=1000*moment().zone(p.getTimezoneOffset()).unix();return o>this.applicationDeadline};this.beginTime=parseInt(b.begin_time);this.hasBegun=function(){var p=new Date();var o=1000*moment().zone(p.getTimezoneOffset()).unix();return o>this.beginTime};if(b.hasOwnProperty("capacity")){this.capacity=parseInt(b.capacity)}if(b.hasOwnProperty("num_applied")){this.numApplied=parseInt(b.num_applied)}if(b.hasOwnProperty("num_selected")){this.numSelected=parseInt(b.num_selected)}if(b.hasOwnProperty("status")){this.status=parseInt(b.status)}this.relation=null;this.containsRelation=function(){return(this.relation!=null&&this.relation!=undefined)};if(b.hasOwnProperty("relation")){this.relation=parseInt(b.relation)}if(b.hasOwnProperty("images")){var h=new Array();var a=b.images;for(var l in a){var g=a[l];var d=new Image(g);h.push(d)}this.images=h}if(b.hasOwnProperty("applied_participants")){var f=new Array();var j=b.applied_participants;for(var l in j){var c=j[l];var k=new User(c);f.push(k)}this.appliedParticipants=f}if(b.hasOwnProperty("selected_participants")){var f=new Array();var j=b.selected_participants;for(var l in j){var c=j[l];var k=new User(c);f.push(k)}this.selectedParticipants=f}if(b.hasOwnProperty("present_participants")){var f=new Array();var j=b.present_participants;for(var l in j){var c=j[l];var k=new User(c);f.push(k)}this.presentParticipants=f}if(b.hasOwnProperty("host")){var n=b.host;var m=new User(n);this.host=m}if(b.hasOwnProperty("viewer")){var i=b.viewer;var e=new User(i);this.viewer=e}if(b.hasOwnProperty("priority")){this.priority=parseInt(b.priority)}if(b.hasOwnProperty("order_mask")){this.orderMask=parseInt(b.order_mask)}}function Comment(a){if(a.hasOwnProperty("id")){this.id=parseInt(a.id)}if(a.hasOwnProperty("content")){this.content=a.content}if(a.hasOwnProperty("activity_id")){this.activityId=parseInt(a.activity_id)}if(a.hasOwnProperty("parent_id")){this.parentId=parseInt(a.parent_id)}if(a.hasOwnProperty("predecessor_id")){this.predecessorId=parseInt(a.predecessor_id)}if(a.hasOwnProperty("generated_time")){this.generatedTime=parseInt(a.generated_time)}if(a.hasOwnProperty("num_children")){this.numChildren=parseInt(a.num_children)}if(a.hasOwnProperty("from")){this.from=parseInt(a.from)}if(a.hasOwnProperty("from_user")){this.fromUser=new User(a.from_user)}if(a.hasOwnProperty("to")){this.to=parseInt(a.to)}if(a.hasOwnProperty("to_user")){this.toUser=new User(a.to_user)}}function Assessment(a){if(a.hasOwnProperty("content")){this.content=a.content}if(a.hasOwnProperty("activity_id")){this.activityId=parseInt(a.activity_id)}if(a.hasOwnProperty("from")){this.from=parseInt(a.from)}if(a.hasOwnProperty("to")){this.to=parseInt(a.to)}if(a.hasOwnProperty("from_user")){this.fromUser=new User(a.from_user)}if(a.hasOwnProperty("to_user")){this.toUser=new User(a.to_user)}}function Notification(a){if(a.hasOwnProperty("id")){this.id=parseInt(a.id)}if(a.hasOwnProperty("is_read")){this.isRead=parseInt(a.is_read)}if(a.hasOwnProperty("from")){this.from=parseInt(a.from)}if(a.hasOwnProperty("to")){this.to=parseInt(a.to)}if(a.hasOwnProperty("content")){this.content=a.content}if(a.hasOwnProperty("activity_id")){this.activityId=parseInt(a.activity_id)}if(a.hasOwnProperty("comment_id")){this.commentId=parseInt(a.comment_id)}if(a.hasOwnProperty("assessment_id")){this.assessmentId=parseInt(a.assessment_id)}if(a.hasOwnProperty("cmd")){this.cmd=parseInt(a.cmd)}if(a.hasOwnProperty("relation")){this.relation=parseInt(a.relation)}if(a.hasOwnProperty("status")){this.status=parseInt(a.status)}if(a.hasOwnProperty("generated_time")){this.generatedTime=parseInt(a.generated_time)}}var g_participantsForm=null;var g_aliasApplied=0;var g_aliasSelected=1;var g_tabParticipants=null;function ParticipantsForm(d,e,a,c,b){this.activity=d;this.idList=c;this.labels=e;this.boxes=a;this.statusList=b}function generateParticipantsSelectionForm(h,b){var a=$("<form>",{"class":"participant-form"}).appendTo(h);var n=currentMillis();var l=(g_loggedInUser!=null&&g_loggedInUser.id==b.host.id&&n<b.beginTime);var r=new Array();var e=new Array();var k=new Array();var c=new Array();for(var m=0;m<b.selectedParticipants.length;++m){var o=b.selectedParticipants[m];k.push(o.id);c.push(g_aliasSelected);var d=$("<p>").appendTo(a);var f=$("<label>",{"class":"participant-label"}).appendTo(d);r.push(f);var j=$("<input>",{type:"checkbox","class":"participant-checkbox"}).appendTo(f);e.push(j);j.hide();var p=$("<img>",{src:o.avatar,"class":"participant-avatar"}).click(o,function(i){i.preventDefault();var t=i.data;window.location.hash=("profile?"+g_keyVieweeId+"="+t.id.toString())}).appendTo(f);var g=$("<plaintext>",{"class":"participant-label-name selected-participant title-beta",text:o.name}).appendTo(f)}for(var m=0;m<b.appliedParticipants.length;++m){var o=b.appliedParticipants[m];k.push(o.id);c.push(g_aliasApplied);var d=$("<p>").appendTo(a);var f=$("<label>",{"class":"participant-label"}).appendTo(d);r.push(f);var j=$("<input>",{type:"checkbox","class":"participant-checkbox"}).appendTo(f);e.push(j);if(!l){j.hide()}var p=$("<img>",{src:o.avatar,"class":"participant-avatar"}).click(function(i){i.preventDefault();window.location.hash=("profile?"+g_keyVieweeId+"="+o.id.toString())}).appendTo(f);var g=$("<plaintext>",{"class":"participant-label-name applied-participant",text:o.name}).appendTo(f)}var s=new ParticipantsForm(b,r,e,k,c);if(!l||b.appliedParticipants.length==0||e.length<=1){return s}var q=$("<button>",{text:TITLES.submit_participant_selection,"class":"purple participant-confirm"}).appendTo(a);q.click(s,function(A){A.preventDefault();var t=A.data;var B=new Array();for(var x=0;x<t.labels.length;x++){var y=t.boxes[x];if(isHidden(y)||!isChecked(y)){continue}var z=t.idList[x];if(z==t.activity.host.id){continue}B.push(z)}if(B.length==0){return}var u=$.cookie(g_keyToken);if(u==null){return}if(B.length+t.activity.numSelected>g_maxSelected){alert(ALERTS.selected_num_exceeded);return}var w={};w[g_keyToken]=u;w[g_keyActivityId]=t.activity.id;w[g_keyBundle]=JSON.stringify(B);var v=getTarget(A);disableField(v);$.ajax({type:"POST",url:"/el/activity/participants/update",data:w,success:function(G,C,H){enableField(v);if(isTokenExpired(G)){logout(null);return}if(isSelectedLimitExceeded(G)){alert(ALERTS.selected_num_exceeded);return}if(!isStandardSuccess(G)){return}for(var E=0;E<t.labels.length;++E){var D=t.labels[E];if(t.statusList[E]==g_aliasSelected){continue}var F=t.boxes[E];if(isHidden(F)||!isChecked(F)){continue}D.removeClass("applied-participant");D.addClass("selected-participant title-beta");F.hide();t.statusList[E]=g_aliasSelected}},error:function(D,i,C){enableField(v)}})});$("<hr>").appendTo(a);return s}var g_fieldPassword=null;var g_fieldRetypePassword=null;var g_spanHint=null;var g_spanRetypeHint=null;var g_btnSubmit=null;var g_email=null;var g_code=null;$(document).ready(function(){$("#reset-hint").text(TITLES.input_to_reset_password);$("#new-password").text(TITLES.new_password);$("#confirm-new-password").text(TITLES.confirm_new_password);var b=extractTagAndParams(window.location.href);var c=b.params;g_email=c.email;g_code=c.code;g_fieldPassword=$("#password-1");g_fieldRetypePassword=$("#password-2");g_spanHint=$("#hint");g_spanRetypeHint=$("retype-hint");g_btnSubmit=$("#submit");g_btnSubmit.text(TITLES.submit);g_fieldPassword.on("input keyup paste",function(d){d.preventDefault();g_spanHint.empty();g_spanHint.text("");var e=$(this).val();if(e==null||e.length==0){return}if(validatePassword(e)){return}g_spanHint.text(MESSAGES.password_requirement)});g_fieldRetypePassword.on("input keyup paster",function(){var d=$(this).val();var e=g_fieldPassword.val();g_spanRetypeHint.empty();g_spanRetypeHint.text("");if(a()){return}g_spanRetypeHint.text(MESSAGES.password_confirm_requirement)});g_btnSubmit.click(function(d){d.preventDefault();var f=g_fieldPassword.val();if(!validatePassword(f)){alert(MESSAGES.password_requirement);return}if(!a()){alert(MESSAGES.password_confirm_requirement);return}var g={};g[g_keyEmail]=g_email;g[g_keyPasswordResetCode]=g_code;g[g_keyPassword]=f;var e=$(d.srcElement?d.srcElement:d.target);disableField(e);$.ajax({type:"POST",url:"/user/password/confirm",data:g,success:function(i,h,j){enableField(e);alert("Password reset successfully!")},error:function(j,h,i){enableField(e);alert("Password NOT reset")}})});function a(){var d=g_fieldPassword.val();var e=g_fieldRetypePassword.val();if(d==null||e==null){return false}if(d!=e){return false}return true}});